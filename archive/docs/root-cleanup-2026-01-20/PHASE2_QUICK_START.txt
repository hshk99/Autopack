================================================================================
                    PHASE 2 QUICK START - AUTOMATED HANDLER
================================================================================

FASTEST WAY TO START:
  C:\dev\Autopack\scripts\handle_connection_errors_automated.bat

WHAT HAPPENS:
  1. Handler starts
  2. Captures baseline screenshots of all 9 grid slots
  3. Begins monitoring continuously
  4. When connection error appears:
     - Detects visual change
     - Automatically clicks Resume button
     - Reports action taken
     - Continues monitoring

================================================================================
                                EXAMPLES
================================================================================

Starting Phase 2:
  C:\dev\Autopack\scripts\handle_connection_errors_automated.bat

Stopping Handler:
  Press Ctrl+C in the handler window

Getting Menu (Phase 1 or Phase 2):
  C:\dev\Autopack\scripts\handle_connection_errors_menu.bat

Switching to Phase 1 (Manual):
  C:\dev\Autopack\scripts\handle_connection_errors.bat

Capturing Error Screenshot (for analysis):
  C:\dev\Autopack\scripts\capture_error_screenshot.ps1 3

================================================================================
                              EXPECTED OUTPUT
================================================================================

STARTUP:
  ========== CONNECTION ERROR HANDLER (AUTOMATED) ==========
  Status: MONITORING ACTIVE
  Method: Screenshot comparison + automatic clicking

  Capturing baseline images for all 9 grid slots...
    Capturing slot 1... [OK]
    Capturing slot 2... [OK]
    ...
  Baseline capture complete.

  Ready. Monitoring grid for connection errors...

WHEN ERROR DETECTED:
  [14:23:45] [!] CONNECTION ERROR DETECTED IN GRID SLOT 3
    Screen changed - likely error dialog appeared
    Attempting to recover...
  [14:23:45] [+] Clicking Resume button in SLOT 3 at (4833, 337)
    [+] Recovery action sent

EXIT (Ctrl+C):
  ========== SESSION SUMMARY ==========
  Session Duration: 0h 2m 15s
  Errors Detected: 2
  Errors Handled: 2
  Monitor stopped.

================================================================================
                                TROUBLESHOOTING
================================================================================

ISSUE: No baseline capture happening
  â†’ Check that Cursor windows are positioned in grid
  â†’ Try: capture_error_screenshot.ps1 3 (test screenshot capture)

ISSUE: No errors detected when they appear
  â†’ This is Phase 2 first run - may need tuning
  â†’ Fallback: Use Phase 1 manual mode (proven working)
  â†’ Run: handle_connection_errors.bat

ISSUE: False positives (clicks when no error)
  â†’ Check error_baselines folder for baseline images
  â†’ May need to adjust MONITOR_INTERVAL_MS in script
  â†’ Fallback: Use Phase 1 manual mode

ISSUE: Errors detected but Resume button not clicking
  â†’ Coordinates may be wrong
  â†’ Fallback: Use Phase 1 to verify coordinates work
  â†’ Run: handle_connection_errors.bat 3

================================================================================
                              KEY DIFFERENCES
================================================================================

Phase 1 (Manual):
  âœ“ You type slot number when error appears
  âœ“ Proven working
  âœ“ 100% accuracy
  âœ— Requires user action each time

Phase 2 (Automated):
  âœ“ Automatic detection
  âœ“ No user action after startup
  âœ— May need tuning
  âœ— Possible false positives

Use Phase 1 if Phase 2 has issues - it's proven working!

================================================================================
                            CONFIGURATION OPTIONS
================================================================================

In handle_connection_errors_automated.ps1:

$MONITOR_INTERVAL_MS = 2000      # Check every 2 seconds (faster = 1000, slower = 5000)
$ERROR_DEBOUNCE_MS = 5000         # Wait 5 seconds between same-slot actions
$BASELINE_DIR = C:\dev\Autopack\error_baselines  # Where baseline images stored

================================================================================
                          RESUME BUTTON COORDINATES
================================================================================

Slot 1 (3121, 337)    Slot 2 (3979, 337)    Slot 3 (4833, 337)
Slot 4 (3121, 801)    Slot 5 (3979, 801)    Slot 6 (4833, 801)
Slot 7 (3121, 1264)   Slot 8 (3979, 1264)   Slot 9 (4833, 1264)

These are hard-coded in both Phase 1 and Phase 2 (confirmed working)

================================================================================
                              STATUS
================================================================================

âœ… Phase 1 (Manual): Proven working
âœ… Phase 2 (Automated): Ready for testing
ðŸ“‹ Testing Guide: PHASE2_AUTOMATED_TESTING_GUIDE.md
ðŸ“„ Full Summary: PHASE2_COMPLETE_SUMMARY.md

================================================================================
                              FALLBACK PLAN
================================================================================

If Phase 2 has issues:

  1. Switch to Phase 1:
     C:\dev\Autopack\scripts\handle_connection_errors.bat

  2. Capture error for analysis:
     C:\dev\Autopack\scripts\capture_error_screenshot.ps1

  3. Phase 1 manual mode is proven working (user confirmed)

================================================================================
                              GET HELP
================================================================================

For complete testing guide:
  â†’ PHASE2_AUTOMATED_TESTING_GUIDE.md

For Phase 2 summary:
  â†’ PHASE2_COMPLETE_SUMMARY.md

For Phase 1 reference:
  â†’ IMMEDIATE_SOLUTION_WORKING.md

For menu selection:
  â†’ handle_connection_errors_menu.bat

================================================================================
