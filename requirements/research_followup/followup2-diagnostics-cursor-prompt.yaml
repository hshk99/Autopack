phase_id: diagnostics-cursor-prompt
run_id: autopack-diagnostics-parity-v1
chunk_number: followup-2
description: |
  Diagnostics Parity (Stage 1B): Cursor-ready prompt generator.

  Produce a single copy/paste prompt that references the handoff bundle and lists:
  - what happened
  - current failure
  - attach/open file list
  - constraints (protected/allowed paths, deliverables if available)

goals:
  - Produce a stable prompt text from an existing handoff bundle
  - Write `handoff/cursor_prompt.md` alongside stdout output

deliverables:
  code:
    - src/autopack/diagnostics/cursor_prompt_generator.py
    - src/autopack/dashboard/server.py
  tests:
    - tests/autopack/diagnostics/test_cursor_prompt_generator.py
  docs:
    - docs/autopack/diagnostics_cursor_prompt.md

features:
  - CLI command: `autopack handoff-prompt --run-id <id>` (or similar)
  - Dashboard integration: endpoint or button that returns the prompt text
  - Prompt includes explicit "attach/open these files" list derived from handoff index.json
  - Prompt includes “unknowns / questions” section if evidence is missing

validation:
  functional:
    - If handoff bundle exists, generator always outputs a prompt and writes cursor_prompt.md
    - Prompt includes file list and constraints every time
  quality:
    - ≥10 unit tests passing


