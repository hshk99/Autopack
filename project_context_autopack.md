# Autopack Project Context

**GitHub repo:** https://github.com/hshk99/Autopack.git  
**Local (Windows):** `C:\dev\Autopack`  
**Local (WSL):** `/mnt/c/dev/Autopack` (optional symlink: `/home/hshk9/Autopack`)

This file defines Autopack’s environment, constraints, and initial expectations so agents (Cursor, Codex, Supervisor) can interpret `autonomous_build_playbook_v7_consolidated.md` correctly.

Autopack is a **Supervisor / orchestrator** that runs zero‑intervention autonomous build runs for arbitrary target projects, following the v7 playbook.

---

## 1. High‑level goals

- Implement the v7 zero‑intervention architecture for autonomous builds:
  - runs, tiers, phases, strategies, budgets, CI gates, issue tracking, and promotion rules.
- Make Autopack reusable as a “control plane” for future projects, not hard‑wired to a single app.
- Minimise manual interaction during autonomous runs; human input is only:
  - before a run (plans, configuration),
  - after a run (review summaries, incidents, promotion decisions).

The **primary design spec** is:

- `autonomous_build_playbook_v7_consolidated.md` at repo root.

Execution is driven chunk‑by‑chunk via:

- `cursor_chunk_prompts_v7.md`.

---

## 2. Environment and path layout

- Windows host:
  - Autopack repo root: `C:\dev\Autopack`
  - Cursor opens: `C:\dev\Autopack`
- WSL (Ubuntu):
  - Mounted path: `/mnt/c/dev/Autopack`
  - Optional symlink: `/home/hshk9/Autopack -> /mnt/c/dev/Autopack`

Assumptions:

- All development commands (git, Docker, Python, CI probes) are run from WSL.
- Cursor runs on Windows but works against the Windows path (`C:\dev\Autopack`), which maps to WSL via `/mnt/c/dev/Autopack`.

Agents must treat any `C:\...` and `/mnt/c/...` paths as referring to the same underlying repo.

---

## 3. Target tech stack (initial)

Autopack v1 is expected to use:

- **Language:** Python 3.11+  
- **Backend framework:** FastAPI (or similar ASGI) for Supervisor APIs  
- **Data storage:** Postgres for:
  - run / tier / phase metadata,
  - metrics, budgets, and strategy snapshots.
- **Message transport:** HTTP/JSON (no hard requirement on queues in v1).
- **Containerisation:** Docker / docker‑compose for:
  - API service,
  - Postgres,
  - optional Qdrant (see §5).

These are defaults, not hard constraints; the playbook is framework‑agnostic. If the stack changes, update this file and v7 only if required.

---

## 4. External tools and roles

Autopack assumes:

- **Cursor Agents** (Builder):
  - used from Windows on `C:\dev\Autopack`,
  - can call WSL‑backed commands (git, docker, pytest) via tasks or scripts.

- **Codex‑class model** (Auditor):
  - accessed via CLI, action, or API as a separate step,
  - not required for v1 implementation of Supervisor, but integrated later per Chunk D in the prompts.

- **CI provider:** GitHub Actions (default)
  - workflows live under `.github/workflows/`,
  - CI profiles (normal/strict) implemented via different jobs / job matrices.

If a different CI provider is used later, this file should be updated to note it.

---

## 5. Vector database and memory

Autopack can run without a vector database. However, for richer retrieval:

- Recommended: **Qdrant** via Docker, with at least:
  - a collection for long‑term “memory” (design docs, plans, etc.),
  - a collection for autonomous run artefacts (run summaries, tier summaries, high‑severity issues, ruleset/strategy snapshots).

Storage:

- Qdrant runs inside WSL Docker,
- volumes are mapped into the WSL filesystem under the repo tree (e.g. `./.qdrant/`) rather than bare Windows paths.

If Qdrant integration is implemented:

- Document the collection names and schemas in a separate `qdrant_config_autopack.md` (to be created when needed).

---

## 6. CI baseline and tooling

Initial expectations for CI and tooling:

- **CI baseline:**  
  - GitHub Actions workflow (e.g. `.github/workflows/ci.yml`) with jobs:
    - `lint` (e.g. `ruff`, `black` in check mode),
    - `test` (pytest),
    - later: autonomous probes (`scripts/autonomous_probe_*.sh` as per v7).

- **Python tooling:**
  - `pyproject.toml` or `requirements.txt` with:
    - `fastapi`, `uvicorn`, `pydantic`,
    - `pytest`,
    - `black`, `ruff`, optional `mypy`.
  - These can be introduced incrementally; v7 does not require a specific linter.

- **Docker baseline:**
  - `docker-compose.yml` skeleton with services:
    - `api` (Autopack Supervisor),
    - `db` (Postgres),
    - optional `qdrant`.

The exact YAML/config can be generated by Cursor later; this file only states expectations.

---

## 7. Relationship to v7 and chunk prompts

- `autonomous_build_playbook_v7_consolidated.md` defines:
  - run/phase/tier model,
  - issue/backlog model,
  - StrategyEngine, high‑risk mappings,
  - CI profiles, budgets, and promotion rules.

- `cursor_chunk_prompts_v7.md` defines a staged implementation plan:
  - Chunk A: core run/phase/tier persistence and dummy probes,
  - Chunk B: issues and backlog,
  - Chunk C: StrategyEngine and rulesets,
  - Chunk D: Builder/Auditor integration points,
  - Chunk E: CI profiles, preflight gate, promotion logic,
  - Chunk F: metrics, calibration, and observability.

This context file is **not** a replacement for v7. It tells agents:

- where they are running,
- which stack to assume,
- how to align CI and Docker with v7.

---

## 8. Reference repos and reuse

There is an existing, separate repo:

- `chatbot_project` (path on Windows: `C:\dev\chatbot_project`)

Guidance:

- Autopack should treat `chatbot_project` as a **reference**, not a dependency.
- Cursor is allowed to:
  - open `C:\dev\chatbot_project` in a separate window,
  - inspect its Supervisor/API patterns and CI configuration,
  - copy small patterns or snippets when they still make sense.

But Autopack must implement its own Supervisor code, endpoints, and configuration around:

- the v7 playbook,
- this project context file.

If patterns from `chatbot_project` conflict with v7, v7 and this context win.

---

## 9. How agents should use this file

When working in Autopack:

1. Read:
   - `autonomous_build_playbook_v7_consolidated.md`,
   - `cursor_chunk_prompts_v7.md`,
   - `project_context_autopack.md` (this document).

2. Assume:
   - the environment and stack in §2–§6,
   - the GitHub remote: `https://github.com/hshk99/Autopack.git`,
   - that runs should be wired to CI via GitHub Actions unless explicitly configured otherwise.

3. For each chunk:
   - use this context for:
     - path assumptions,
     - Docker/CI assumptions,
     - reference repo usage,
   - but follow the detailed behaviour from v7 and the chunk prompts.

4. Do not change this file arbitrarily; if fundamental assumptions change (CI provider, DB choice, etc.), update this file in a dedicated “context update” commit.
