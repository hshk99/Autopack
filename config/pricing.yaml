# LLM Pricing Configuration
# Updated: 2025-12-01
# Prices in USD per 1,000 tokens

# Anthropic Claude pricing (as of 2025)
# Source: https://www.anthropic.com/pricing
# Environment: ANTHROPIC_API_KEY
anthropic:
  "claude-opus-4-5":
    input_per_1k: 0.015     # $15.00 per 1M tokens
    output_per_1k: 0.075    # $75.00 per 1M tokens

  "claude-sonnet-4-5":
    input_per_1k: 0.003     # $3.00 per 1M tokens
    output_per_1k: 0.015    # $15.00 per 1M tokens

  "claude-3-opus-20240229":
    input_per_1k: 0.015     # $15.00 per 1M tokens
    output_per_1k: 0.075    # $75.00 per 1M tokens

  "claude-3-sonnet-20240229":
    input_per_1k: 0.003     # $3.00 per 1M tokens
    output_per_1k: 0.015    # $15.00 per 1M tokens

  "claude-3-haiku-20240307":
    input_per_1k: 0.00025   # $0.25 per 1M tokens
    output_per_1k: 0.00125  # $1.25 per 1M tokens

# OpenAI pricing (as of 2025) - FALLBACK PROVIDER
# Source: https://openai.com/api/pricing/
# Environment: OPENAI_API_KEY
# Note: OpenAI models are no longer primary; Claude Sonnet 4.5 is preferred for all tiers
openai:
  "gpt-4.5":
    input_per_1k: 0.075     # $75.00 per 1M tokens
    output_per_1k: 0.15     # $150.00 per 1M tokens

  "gpt-4-turbo-2024-04-09":
    input_per_1k: 0.01      # $10.00 per 1M tokens
    output_per_1k: 0.03     # $30.00 per 1M tokens

  # Legacy models (kept for reference, not actively used)
  "gpt-4o":
    input_per_1k: 0.0025    # $2.50 per 1M tokens
    output_per_1k: 0.01     # $10.00 per 1M tokens

  "gpt-4o-mini":
    input_per_1k: 0.00015   # $0.150 per 1M tokens
    output_per_1k: 0.0006   # $0.600 per 1M tokens

  "gpt-3.5-turbo":
    input_per_1k: 0.0005
    output_per_1k: 0.0015

# Google Gemini pricing - OPTIONAL/DEPRECATED
# Source: https://ai.google.dev/pricing
# Environment: GOOGLE_API_KEY
# Note: Gemini models replaced by Claude Sonnet 4.5 for better performance
google:
  "gemini-2.5-flash":
    input_per_1k: 0.00035   # $0.35 per 1M tokens
    output_per_1k: 0.00105  # $1.05 per 1M tokens

  "gemini-2.5-flash-lite":
    input_per_1k: 0.000075  # $0.075 per 1M tokens
    output_per_1k: 0.0003   # $0.30 per 1M tokens

# Cost calculation helpers
cost_calculation:
  # How to calculate total cost for a call
  # total_cost = (input_tokens * input_per_1k / 1000) + (output_tokens * output_per_1k / 1000)

  # Track costs at multiple levels
  track_at_levels:
    - phase    # Cost per phase
    - tier     # Cost per tier
    - run      # Cost per run
    - project  # Cost across all runs (project backlog)

# Budget enforcement
budgets:
  # Maximum cost per run (optional, in addition to token cap)
  run_cost_cap_usd: null  # Set to dollar amount to enable, e.g., 50.0

  # Alert thresholds (percentage of budget used)
  cost_warning_threshold: 0.75  # Warn at 75% of budget
  cost_critical_threshold: 0.90  # Critical alert at 90%

# Cost optimization strategies
optimization:
  # Use cheaper models for retries after initial failure
  use_cheaper_model_on_retry: false

  # Cache common prompts (if LLM provider supports it)
  enable_prompt_caching: false

  # Batch multiple small operations when possible
  enable_batching: false

# Reporting
reporting:
  # Include cost breakdown in run summaries
  include_cost_in_summaries: true

  # Cost metrics to track
  metrics:
    - total_cost_usd
    - cost_per_phase_avg
    - cost_by_task_category
    - cost_by_model
    - builder_cost_vs_auditor_cost
    - cost_per_successful_phase
    - cost_per_failed_phase

# Example cost calculations for reference (current model stack):
#
# Low complexity phase (claude-sonnet-4-5):
#   - Builder: 2000 input + 1000 output = $0.024 (2*0.003 + 1*0.015)
#   - Auditor: 1500 input + 500 output = $0.0135 (1.5*0.003 + 0.5*0.015)
#   - Total: ~$0.0375 per phase
#
# Medium complexity phase (claude-sonnet-4-5):
#   - Builder: 5000 input + 3000 output = $0.060 (5*0.003 + 3*0.015)
#   - Auditor: 3000 input + 1000 output = $0.024 (3*0.003 + 1*0.015)
#   - Total: ~$0.084 per phase
#
# High complexity phase (claude-sonnet-4-5):
#   - Builder: 10000 input + 5000 output = $0.105 (10*0.003 + 5*0.015)
#   - Auditor: 8000 input + 2000 output = $0.054 (8*0.003 + 2*0.015)
#   - Total: ~$0.16 per phase
#
# Estimated run cost (25 phases, mixed complexity):
#   - 5 low + 15 medium + 5 high
#   - ~$0.19 + $1.26 + $0.80 = ~$2.25 per run
#
# Model stack summary (current routing):
#   - Low: Claude Sonnet 4.5 (Anthropic) - default for low-complexity phases
#   - Medium: Claude Sonnet 4.5 (Anthropic) - excellent cost/quality balance
#   - High: Claude Sonnet 4.5 (Anthropic) - premium quality
#   - Escalation: Claude Opus 4.5 - for critical/failing phases
